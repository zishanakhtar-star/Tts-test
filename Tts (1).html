<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Text to Speech (PlayHT)</title>
</head>
<body>
    <h2>Text-to-Speech (PlayHT)</h2>

    <!-- Text input -->
    <textarea id="textInput" rows="4" cols="50" placeholder="Enter text to convert..."></textarea><br><br>

    <!-- Voice selection -->
    <label for="voiceSelect">Choose a Voice:</label>
    <select id="voiceSelect">
        <option value="Charlotte">Charlotte</option>
        <option value="Matthew">Matthew</option>
        <option value="Grace">Grace</option>
    </select><br><br>

    <!-- Generate and Play Buttons -->
    <button onclick="generateSpeech()">Generate Speech</button>
    <button id="playAudio" style="display:none;" onclick="playAudio()">Play Audio</button>

    <!-- Progress & Audio Output -->
    <p id="status"></p>
    <audio id="audioPlayer" controls style="display:none;"></audio>

    <script>
        const API_KEY = "d17da4ab16d242c18760c8716329d8bb";  // Replace with your API key
        const USER_ID = "wJCzg2GnAtSfYgUKMFUawoi6ibq2";  // Replace with your User ID

        async function generateSpeech() {
            let text = document.getElementById("textInput").value;
            let voice = document.getElementById("voiceSelect").value;

            if (!text) {
                alert("Please enter some text!");
                return;
            }

            document.getElementById("status").innerText = "Generating audio...";
            document.getElementById("playAudio").style.display = "none";

            // API request to PlayHT
            const response = await fetch("https://api.play.ht/api/v2/tts", {
                method: "POST",
                headers: {
                    "Authorization": `Bearer ${API_KEY}`,
                    "X-User-ID": USER_ID,
                    "Content-Type": "application/json"
                },
                body: JSON.stringify({
                    text: text,
                    voice: voice,
                    output_format: "mp3"
                })
            });

            if (!response.ok) {
                document.getElementById("status").innerText = "Error generating audio!";
                alert("Failed to generate speech. Check API key and voice selection.");
                return;
            }

            const data = await response.json();
            const audioUrl = data.url;  // The generated audio file URL

            if (audioUrl) {
                document.getElementById("audioPlayer").src = audioUrl;
                document.getElementById("audioPlayer").style.display = "block";
                document.getElementById("playAudio").style.display = "inline-block";
                document.getElementById("status").innerText = "Audio ready!";
            }
        }

        function playAudio() {
            document.getElementById("audioPlayer").play();
        }
    </script>
</body>
</html>